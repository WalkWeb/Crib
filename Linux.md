
# Полезные команды по Linux

Сведения о системе:

`inxi -v5 -z`

Посмотреть процессы:

`htop`

При прерывании установки пакета:

`sudo dpkg --configure -a`

Мониторинг всех http запросов (результат по умолчанию сохраняется в отдельных файлах в вашей домашней директории):

`sudo tcpflow port 80`

Посчитать количество строк в .php файлах в указанной директории:

`find /var/www/site.loc/ -name "*.php" -type f -exec wc -l {} \; | awk 'BEGIN{sum=0}{sum+=$1;}END{print sum;}'`

Запись видео с экрана:

`ffmpeg -y -f alsa -i pulse -f x11grab -s 1920x1080 -r 25 -i :0.0 -vcodec mpeg4 -qscale 0 -f avi -acodec pcm_s16le /var/www/video.avi`


## Linux screen

Список существующих скринов:

`screen -list`

Создать скрин:

`screen`

Создать скрин с определенным именем:

`screen -S ScreenName`

Зайти в определенный скрин:

`screen -r ScreenName`


Выйти из скрина оставив его работать:

`Ctrl + A после чего нажать  D`

Закрыть скрин:

`exit`


## Температура процессоров

Установка пакета:

`sudo apt-get install lm-sensors`

Обнаружение всех датчиков (чтобы выбрать все по-умолчанию - просто нажимайте Enter на каждом вопросе):

`sudo sensors-detect`

Непосредственно просмотр температуры:

`sensors`


## auditctl - мониторинг системных событий в Linux

Установка

`sudo apt-get install auditd`

Создаем правило, например, для мониторинга системных вызовов, включая доступ к файлам от лица пользователя с id 80

`auditctl -a exit,always -F arch=x86_64 -S open -F auid=80`

Рестартуем, чтобы правило вступило в действие

`sudo service auditd restart`

Посмотреть логи

`sudo ausearch -ui 80`

Удалить все созданные правила

`sudo auditctl -D`


## Проверка открытых портов

nc -zvw3 example.com 80


## Автоматическая передача аргументов и/или запись результата в файл

Рассмотрим на примере программы [square](https://github.com/WalkWeb/Crib/blob/master/Pascal.md) на Pascal, которая 
принимает к себе на вход число, и возвращает его же в квадрате.

Иногда нужно автоматизировать передачу и получение параметров. Ниже идут примеры таких вариантов:

Передать параметр сразу в программу:

`echo 100 | ./square`

Передать параметр в программу из файла `input` содержащий в себе одну строку с цифрой, которая будет передана программе:

`./square < input`

Передать параметр сразу и записать полученный вариант в файл `output`:

`echo 3 | ./square 3 > output`


## Железо

Посмотреть информацию по жестким дискам:

`lshw -C disk`


## Прочее

Запуск программы в фоне:

`program_name &`

Убить фоновую программу по id:

`kill %123`

Передача файлов по ssh:

`scp /path/to/file user@255.255.255.255:/new/path/`

Директории со всеми поддиректории и файлами:

`scp -r /path/to/directory/ root@185.105.224.221:/new/path`
